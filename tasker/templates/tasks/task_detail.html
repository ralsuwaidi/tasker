{% extends "base.html" %}
{% load static %}

{% block title %}Task List{% endblock %}

{% block content %}
<div class="container mb-3">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="{% url 'tasks:list' %}">Tasks</a></li>
      <li class="breadcrumb-item active" aria-current="page">Task</li>
    </ol>
  </nav>
  <div class="row">
    <div class="col-sm-12">

      <h2>Task: {{object.name}}</h2>
      <a class="btn btn-primary my-3" href="{% url 'tasks:update' object.id %}" role="button">Edit</a>
      <ul class="list-group">
        <li class="list-group-item">Name: {{ object.name }}</li>
        <li class="list-group-item">{{ object.description|linebreaks }}</li>
        {% if object.responsible %}
        <li class="list-group-item">Assigned to: {{ object.responsible }}</li>
        {% endif %}
        <li class="list-group-item">Completed: {{ object.is_completed }}</li>
        {% if object.deadline %}
        <li class="list-group-item">Deadline: {{ object.deadline }}</li>
        {% else %}
        <li class="list-group-item">Deadline: There is no deadline</li>
        {% endif %}
        <li class="list-group-item">Created by: {{ object.created_by }}</li>
        <li class="list-group-item">Task time spent: {{object.time_spent_total}}</li>
      </ul>
    </div>

  </div>

  <a class="btn btn-primary my-3" href="{% url 'tasks:update_create' object.id %}" role="button">Add Update</a>

  {% if object.update_set.count > 0 %}
  <div class=" mt-2 mb-5">
    <div class="row">
      <div class="col-md-6">
        <h4>Updates</h4>
        <ul class="timeline">
          {% for update in object.update_set.all|dictsortreversed:"created_at" %}
          <li>
            <a target="_blank" href="{% url 'users:detail' update.created_by.pk %}">{{update.created_by.username}}</a>
            <p class="float-right">{{update.created_at}}</p>
            <p>{{update.comment}}</p>
            {% if update.file %}
              <p class="text-muted"><small>file upload <a href="{{update.file.url}}" class="text-reset">{{update.file}}</a></small></p>
            {% endif %}
            {% if update.time_spent %}
              <p class="text-muted"><small>Time spent: {{update.time_spent_display}}</a></small></p>
            {% endif %}
          </li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
  {% endif %}


  </div>



{% endblock content %}


